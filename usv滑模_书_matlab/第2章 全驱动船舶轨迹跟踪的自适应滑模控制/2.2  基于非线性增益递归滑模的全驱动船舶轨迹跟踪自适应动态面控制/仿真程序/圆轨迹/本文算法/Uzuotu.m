close all;
figure(1);
plot(X,Y,'b',x,y,'r:','linewidth',2.5);
xlabel('x/m');ylabel('y/m');
legend('参考轨迹','本文算法');

figure(2);
subplot(311);
plot(t,X,'b',t,x,'r:','linewidth',2.5);
ylabel('m');
legend('xd','x');
subplot(312);
plot(t,Y,'b',t,y,'r:','linewidth',2.5);
ylabel('m');
legend('yd','y');
subplot(313);
plot(t,0.01*t,'b',t,psi,'r:','linewidth',2.5);
xlabel('t/s');ylabel('rad');
legend('\psid','\psi');

figure(3);
subplot(311);
plot(t,ut,'b','linewidth',2.5);
ylabel('u/m/s');
subplot(312);
plot(t,v,'b','linewidth',2.5);
ylabel('v/m/s');
subplot(313);
plot(t,r,'b','linewidth',2.5);
xlabel('t/s');ylabel('r/rad/s');

figure(4);
subplot(311);
plot(t,TAO(:,1)/1000,'linewidth',2.5);
ylabel('\tau_1/kN');
subplot(312);
plot(t,TAO(:,2)/1000,'linewidth',2.5);
ylabel('\tau_2/kN');
subplot(313);
plot(t,TAO(:,3)/1000,'linewidth',2.5);
xlabel('t/s');ylabel('\tau_3/kN\cdotm');

figure(5);
subplot(311);
plot(t,f1/1000,'b',t,FG(:,1)/1000,'r:','linewidth',2.5);
ylabel('kN');
legend('f_1','NN_1');
subplot(312);
plot(t,f2/1000,'b',t,FG(:,2)/1000,'r:','linewidth',2.5);
ylabel('kN');
legend('f_2','NN_2');
subplot(313);
plot(t,f3/1000,'b',t,FG(:,3)/1000,'r:','linewidth',2.5);
xlabel('t/s');ylabel('kN\cdotm');
legend('f_3','NN_3');

figure(6);
subplot(311);
plot(t,(deata1)/1000,'r',t,DGJ(:,1)/1000,'linewidth',2.5);
ylabel('kN');
legend('\delta_1','\delta_1估计值');
subplot(312);
plot(t,(deata2)/1000,'r',t,DGJ(:,2)/1000,'linewidth',2.5);
ylabel('kN');
legend('\delta_2','\delta_2估计值');
subplot(313);
plot(t,(deata3)/1000,'r',t,DGJ(:,3)/1000,'linewidth',2.5);
xlabel('t/s');ylabel('kN\cdotm');
legend('\delta_3','\delta_3估计值');

figure(7);
subplot(311);
plot(t,(f1-FG(:,1))/1000,'linewidth',2.5);
ylabel('f_1逼近误差/kN');
subplot(312);
plot(t,(f2-FG(:,2))/1000,'linewidth',2.5);
ylabel('f_2逼近误差/kN');
subplot(313);
plot(t,(f3-FG(:,3))/1000,'linewidth',2.5);
xlabel('t/s');ylabel('f_3逼近误差/kN\cdotm');

figure(8);
subplot(311);
plot(t,x-X,'b','linewidth',2.5);
ylabel('x_e/m');
subplot(312);
plot(t,y-Y,'b','linewidth',2.5);
ylabel('y_e/m');
subplot(313);
plot(t,psi-0.01*t,'b','linewidth',2.5);
xlabel('t/s');ylabel('\psi_e/rad');

figure(9);
plot(t,sqrt((x-X).^2+(y-Y).^2+(psi-0.01*t).^2),'b','linewidth',2.5);
xlabel('t/s');ylabel('||z_1||');

% figure(10);
% subplot(311);
% plot(t,WW(:,1),'linewidth',2.5);
% ylabel('||W_1||');
% subplot(312);
% plot(t,WW(:,2),'linewidth',2.5);
% ylabel('||W_2||');
% subplot(313);
% plot(t,WW(:,3),'linewidth',2.5);
% xlabel('t/s');ylabel('||W_3||');
figure(10);
subplot(311);
plot(t,S2(:,1),'linewidth',2.5);
ylabel('||W_1||');
subplot(312);
plot(t,S2(:,2),'linewidth',2.5);
ylabel('||W_2||');
subplot(313);
plot(t,S2(:,3),'linewidth',2.5);
xlabel('t/s');ylabel('||W_3||');


figure(11);
subplot(311);
plot(t,abs(deata1)/1000+abs(f1-FG(:,1))/1000,'r',t,DGJ(:,1)/1000,'linewidth',2.5);
ylabel('kN');
legend('\delta_1','\delta_1估计值');
subplot(312);
plot(t,abs(deata2)/1000+abs(f2-FG(:,2))/1000,'r',t,DGJ(:,2)/1000,'linewidth',2.5);
ylabel('kN');
legend('\delta_2','\delta_2估计值');
subplot(313);
plot(t,abs(deata3)/1000+abs(f3-FG(:,3))/1000,'r',t,DGJ(:,3)/1000,'linewidth',2.5);
xlabel('t/s');ylabel('kN\cdotm');
legend('\delta_3','\delta_3估计值');

figure(12);
subplot(311);
plot(t,E(:,1),'linewidth',2.5);
ylabel('||W_1||');
subplot(312);
plot(t,E(:,2),'linewidth',2.5);
ylabel('||W_2||');
subplot(313);
plot(t,E(:,3),'linewidth',2.5);
xlabel('t/s');ylabel('||W_3||');